name: deploy

on:
  push:
    branches: [main]
  pull_request:
    branches: [main]

jobs:
  build-and-deploy:
    runs-on: ubuntu-latest
    steps:
      # ì €ì¥ì†Œ ì½”ë“œ ë‹¤ìš´ë¡œë“œ
      - name: Checkout Code
        uses: actions/checkout@5
      # pnpm ì„¤ì¹˜
      - name: Install pnpm
        uses: pnpm/action-setup@v4
        with:
          version: 10
      # node.js í™˜ê²½ ì„¤ì •
      - name: Setup Node.js
        uses: actions/setup-node@v6
        with:
          node-version: "22.x"
          cache: "pnpm" # ìºì‹±í•´ë†“ì€ íŒ¨í‚¤ì§€ ê´€ë¦¬ì
      # ë¼ì´ë¸ŒëŸ¬ë¦¬ ì„¤ì¹˜
      - name: Install dependencies
        run: pnpm install # ë½íŒŒì¼ì´ ì—†ì–´ë„ ì˜ì¡´ì„± ì„¤ì¹˜ ê°€ëŠ¥
      # í”„ë¡œì íŠ¸ ë¹Œë“œ
      - name: Build project
        id: build_step
        run: pnpm build
        continue-on-error: true
      # ë¹Œë“œ ê²°ê³¼
      - name: Output build result
        if: always()
        run: |
          echo "### ğŸš€ ë¹Œë“œ ê²°ê³¼ " >> $GITHUB_STEP_SUMMARY

          if [ "${{ steps.build_step.outcome }}" == "success" ]; then
            echo "** ë¹Œë“œ ì„±ê³µ âœ… **" >> $GIHUB_STEP_SUMMARY
          else
            echo "** ë¹Œë“œ ì‹¤íŒ¨ âŒ **" >> $GITHUB_STEP_SUMMARY
            exit 1
          fi
  assign:
    runs-on: ubuntu-latest
    steps:
      - name: auto-assign-author-and-reviewer
        if: github.event_name == 'pull_request'&&github.event.action=='opened'
        uses: kentaro-m/auto-assign-action@v2.0.0
        with:
          assignees: ${{github.actor}} # ë‹´ë‹¹ì ì„¤ì •
          # reviewers: a, b, c (ë¦¬ë·°ì–´ë¥¼ ìë™ ì„¤ì •í•©ë‹ˆë‹¤)
